// cypress/e2e/admin/dashboard.cy.js
// üîí ‡∏ó‡∏î‡∏™‡∏≠‡∏ö‡∏´‡∏ô‡πâ‡∏≤‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô (http://localhost:3000/admin)
// - ‡∏£‡∏≠‡∏á‡∏£‡∏±‡∏ö frontend ‡πÉ‡∏´‡∏°‡πà ‡πÑ‡∏°‡πà fix ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç
// - ‡∏ï‡∏£‡∏ß‡∏à header, cards, room map, charts, dropdown ‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ô‡πâ‡∏≥-‡πÑ‡∏ü‡∏ü‡πâ‡∏≤

describe('Admin Dashboard Overview Page', () => {
  beforeEach(() => {
    cy.loginPreset(); // login ‡∏Å‡πà‡∏≠‡∏ô‡∏ó‡∏∏‡∏Å test
    cy.visit('/admin');
  });

  it('1 ‡πÅ‡∏™‡∏î‡∏á‡∏´‡∏±‡∏ß‡∏Ç‡πâ‡∏≠‡∏´‡∏•‡∏±‡∏Å‡πÅ‡∏•‡∏∞‡∏Ñ‡∏≥‡∏≠‡∏ò‡∏¥‡∏ö‡∏≤‡∏¢‡∏Ñ‡∏£‡∏ö', () => {
    cy.contains('‡πÅ‡∏î‡∏ä‡∏ö‡∏≠‡∏£‡πå‡∏î‡πÅ‡∏≠‡∏î‡∏°‡∏¥‡∏ô').should('be.visible');
    cy.contains('‡∏†‡∏≤‡∏û‡∏£‡∏ß‡∏°‡∏£‡∏∞‡∏ö‡∏ö‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏≠‡∏û‡∏≤‡∏£‡πå‡∏ï‡πÄ‡∏°‡∏ô‡∏ï‡πå').should('be.visible');
  });

  it('2 ‡∏ï‡∏£‡∏ß‡∏à‡∏Å‡∏≤‡∏£‡πå‡∏î‡∏™‡∏ñ‡∏¥‡∏ï‡∏¥‡∏´‡∏•‡∏±‡∏Å (‡πÑ‡∏°‡πà fix ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç)', () => {
    const cards = [
      '‡∏´‡πâ‡∏≠‡∏á‡∏û‡∏±‡∏Å‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î',
      '‡∏´‡πâ‡∏≠‡∏á‡∏ó‡∏µ‡πà‡πÉ‡∏´‡πâ‡πÄ‡∏ä‡πà‡∏≤',
      '‡πÉ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏´‡∏ô‡∏µ‡πâ‡∏Ñ‡πâ‡∏≤‡∏á‡∏ä‡∏≥‡∏£‡∏∞',
      '‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°‡∏ó‡∏µ‡πà‡πÄ‡∏õ‡∏¥‡∏î‡∏≠‡∏¢‡∏π‡πà'
    ];

    cards.forEach((label) => {
      cy.contains(label).should('exist');
      cy.contains(label).parent().within(() => {
        cy.get('.fs-4, .fw-bold').should('exist'); // ‡∏°‡∏µ‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç‡∏™‡∏£‡∏∏‡∏õ
      });
    });
  });

  it('3 ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡πà‡∏ß‡∏ô ‚Äú‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏´‡πâ‡∏≠‡∏á‚Äù ‡∏ß‡πà‡∏≤‡∏°‡∏µ‡∏´‡πâ‡∏≠‡∏á‡πÅ‡∏™‡∏î‡∏á ‡πÅ‡∏•‡∏∞‡∏Å‡∏î‡πÑ‡∏î‡πâ', () => {
    cy.contains('‡πÅ‡∏ú‡∏ô‡∏ó‡∏µ‡πà‡∏´‡πâ‡∏≠‡∏á').should('be.visible');
    cy.get('.room').should('have.length.greaterThan', 5);
    cy.get('.room').first().click();
  });

  it('4 ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡πà‡∏ß‡∏ô ‚Äú‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏±‡∏Å‚Äù ‡πÅ‡∏•‡∏∞ ‚Äú‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ‚Äù', () => {
    cy.contains('‡∏≠‡∏±‡∏ï‡∏£‡∏≤‡∏Å‡∏≤‡∏£‡πÄ‡∏Ç‡πâ‡∏≤‡∏û‡∏±‡∏Å').should('exist');
    cy.get('.text-primary').should('exist'); // % occupancy
    cy.get('.progress-bar').should('exist'); // ‡πÅ‡∏ñ‡∏ö‡∏Å‡∏£‡∏≤‡∏ü

    cy.contains('‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏ô‡∏µ‡πâ').should('exist');
    cy.contains('‡∏ø').should('exist');
  });

  it('5 ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡πà‡∏ß‡∏ô ‚Äú‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ô‡πâ‡∏≥-‡πÑ‡∏ü‡∏ü‡πâ‡∏≤‚Äù ‡πÅ‡∏•‡∏∞‡∏™‡∏•‡∏±‡∏ö dropdown filter', () => {
    // cy.contains('‡∏Å‡∏≤‡∏£‡πÉ‡∏ä‡πâ‡∏ô‡πâ‡∏≥-‡πÑ‡∏ü‡∏ü‡πâ‡∏≤').should('be.visible');

    cy.get('select.form-select-sm').as('usageSelects');

    // ‡∏ä‡∏±‡πâ‡∏ô
    cy.get('@usageSelects').eq(0).select('1', { force: true });
    cy.wait(300);
    cy.get('@usageSelects').eq(0).select('2', { force: true });

    // ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡πÄ‡∏£‡∏¥‡πà‡∏°
    cy.get('@usageSelects').eq(1).select('‡∏°‡∏Å‡∏£‡∏≤‡∏Ñ‡∏°', { force: true });
    cy.wait(300);
    cy.get('@usageSelects').eq(1).select('‡∏ï‡∏∏‡∏•‡∏≤‡∏Ñ‡∏°', { force: true });

    // ‡πÄ‡∏î‡∏∑‡∏≠‡∏ô‡∏™‡∏¥‡πâ‡∏ô‡∏™‡∏∏‡∏î
    cy.get('@usageSelects').eq(2).select('‡∏û‡∏§‡∏®‡∏à‡∏¥‡∏Å‡∏≤‡∏¢‡∏ô', { force: true });
    cy.wait(300);
    cy.get('@usageSelects').eq(2).select('‡∏ò‡∏±‡∏ô‡∏ß‡∏≤‡∏Ñ‡∏°', { force: true });

    // ‡∏õ‡∏µ
    cy.get('@usageSelects').eq(3).select('2025', { force: true });
    cy.wait(300);
    cy.get('@usageSelects').eq(3).select('2024', { force: true });

    cy.get('.recharts-surface').should('exist'); // ‡∏°‡∏µ‡∏Å‡∏£‡∏≤‡∏ü‡πÅ‡∏™‡∏î‡∏á‡∏ú‡∏•
  });

  it('6 ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡πà‡∏ß‡∏ô ‚Äú‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‚Äù ‡πÅ‡∏•‡∏∞ ‚Äú‡πÉ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏´‡∏ô‡∏µ‡πâ‡∏Ñ‡πâ‡∏≤‡∏á‡∏ä‡∏≥‡∏£‡∏∞‚Äù', () => {
    cy.contains('‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á').should('exist');
    cy.get('.card').contains('‡∏á‡∏≤‡∏ô‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á').parent().within(() => {
      // cy.get('.vstack').should('exist');
    });

    cy.contains('‡πÉ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏´‡∏ô‡∏µ‡πâ‡∏Ñ‡πâ‡∏≤‡∏á‡∏ä‡∏≥‡∏£‡∏∞').should('exist');
    cy.get('.card').contains('‡πÉ‡∏ö‡πÅ‡∏à‡πâ‡∏á‡∏´‡∏ô‡∏µ‡πâ‡∏Ñ‡πâ‡∏≤‡∏á‡∏ä‡∏≥‡∏£‡∏∞').parent().within(() => {
      // cy.get('.vstack').should('exist');
    });
  });

  it('7 ‡∏ï‡∏£‡∏ß‡∏à‡∏™‡πà‡∏ß‡∏ô ‚Äú‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á‚Äù ‡πÅ‡∏•‡∏∞ ‚Äú‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡πà‡∏á‡∏Ç‡∏≠‡∏á‚Äù', () => {
    cy.contains('‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á').should('exist');
    cy.contains('‡∏Ñ‡∏•‡∏±‡∏á‡∏™‡∏¥‡πà‡∏á‡∏Ç‡∏≠‡∏á').should('exist');
    cy.contains('‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏ï‡∏≤‡∏£‡∏≤‡∏á‡∏Å‡∏≤‡∏£‡∏ã‡πà‡∏≠‡∏°‡∏ö‡∏≥‡∏£‡∏∏‡∏á').should('exist');
    cy.contains(/‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏•‡∏ó‡∏≠‡∏ô‡πâ‡∏≠‡∏¢‡∏´‡∏£‡∏∑‡∏≠‡∏´‡∏°‡∏î|‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏™‡∏¥‡πà‡∏á‡∏Ç‡∏≠‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠‡∏ô‡πâ‡∏≠‡∏¢/).should('exist');
  });
});